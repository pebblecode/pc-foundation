<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <SolutionDir Condition="'$(SolutionDir)' == '' OR '$(SolutionDir)' == '*Undefined*'">$(MSBuildProjectDirectory)\..\</SolutionDir>
    <RepoDir Condition="'$(RepoDir)' == ''">$(MSBuildProjectDirectory)\..\..</RepoDir>
    <MSBuildCommunityTasksPath>$(RepoDir)\src\packages\MSBuildTasks.1.4.0.45\tools</MSBuildCommunityTasksPath>
  </PropertyGroup>
  
  <Import Project="$(MSBuildCommunityTasksPath)\MSBuild.Community.Tasks.Targets"/>
  
  <Target Name="CopyToSolutionPackageDir" AfterTargets="Compile" DependsOnTargets="Compile" Condition="'$(OutputType)' != 'WinExe'">
    <PropertyGroup>
      <SourceOutputDir>$(MSBuildProjectDirectory)\obj\$(Configuration)</SourceOutputDir>
    </PropertyGroup>
    <ItemGroup>
      <ProjOutputFile Include="$(SourceOutputDir)\*.dll;$(SourceOutputDir)\*.xml;$(SourceOutputDir)\*.pdb"/>
    </ItemGroup>
    <ItemGroup>
      <ToolsOutputFile Include="$(RepoDir)\utils\*.exe"/>
    </ItemGroup>
    <ItemGroup>
      <ContentOutputFile Include="$(RepoDir)\build\**\*"/>
    </ItemGroup>
    <ItemGroup>
      <ProjOutputFile Include="$(SourceOutputDir)\*.dll;$(SourceOutputDir)\*.xml;$(SourceOutputDir)\*.pdb"/>
    </ItemGroup>
    <Copy SourceFiles="@(ProjOutputFile)"
          DestinationFolder="$(SolutionDir)\obj\$(Configuration)\lib" />
    <Copy SourceFiles="$(ToolsOutputFile)"
          DestinationFolder="$(SolutionDir)\obj\$(Configuration)\tools" />
    <Copy SourceFiles="@(ContentOutputFile)"
          DestinationFolder="$(SolutionDir)\obj\$(Configuration)\content" />
  </Target>
  
</Project>