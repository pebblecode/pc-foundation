<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <SolutionDir Condition="'$(SolutionDir)' == '' OR '$(SolutionDir)' == '*Undefined*'">$(MSBuildProjectDirectory)\..\</SolutionDir>
    <RepoDir Condition="'$(RepoDir)' == ''">$(MSBuildProjectDirectory)\..\..</RepoDir>
    <MSBuildCommunityTasksPath>$(RepoDir)\src\packages\MSBuildTasks.1.4.0.45\tools</MSBuildCommunityTasksPath>
  </PropertyGroup>
  
  <Import Project="$(MSBuildCommunityTasksPath)\MSBuild.Community.Tasks.Targets"/>
  
  <Target Name="CopyToSolutionPackageDir" AfterTargets="Compile" DependsOnTargets="Compile">
	<Message Text="$(MSBuildProjectDirectory)" />
    <PropertyGroup>
      <SourceOutputDir>$(MSBuildProjectDirectory)\obj\$(Configuration)</SourceOutputDir>
    </PropertyGroup>
			
	<ItemGroup>
		<ProjOutputFile Include="$(SourceOutputDir)\*.dll;$(SourceOutputDir)\*.xml;$(SourceOutputDir)\*.pdb" Condition="'$(OutputType)' != 'WinExe'" />
		<ProjOutputFile Include="$(SourceOutputDir)\*.exe;$(SourceOutputDir)\*.pdb" Condition="'$(OutputType)' == 'WinExe'" />
	</ItemGroup>
	
	<Copy SourceFiles="@(ProjOutputFile)"
		  DestinationFolder="$(SolutionDir)\obj\$(Configuration)\lib" Condition="'$(OutputType)' != 'WinExe'" />
	<Copy SourceFiles="@(ProjOutputFile)"
		  DestinationFolder="$(SolutionDir)\obj\$(Configuration)\tools" Condition="'$(OutputType)' == 'WinExe'" />
	
  </Target>
  
</Project>